(this["webpackJsonphb-frontend"]=this["webpackJsonphb-frontend"]||[]).push([[78],{1200:function(e,t,i){"use strict";i.r(t);var a=i(4),n=i(58),c=i(8),l=i(27),d=i(1),s=i(31),o=i(53),r=i(57),u=i(649),j=i(102),b=i.n(j),O=i(605),m=i(34),g=i(45),h=i(28),v=i(59),f=i(35),p=[{key:"no",_style:{width:"4%"}},{key:"name",label:"Title",_style:{width:160}},{key:"description",_style:{width:"24%"}},{key:"created_date",_style:{width:"8%"}},{key:"modified_date",label:"Last modified",_style:{width:"8%"}},{key:"uploader",_style:{width:"10%"}},{key:"tag",_style:{width:"5%"}},{key:"views",_style:{width:"5%"}},{key:"comment",_style:{width:"5%"}},{key:"like",_style:{width:"5%"}},{key:"status",_style:{width:"8%"}},{key:"action",_style:{width:"10%"}}];t.default=function(e){Object(u.a)().t;var t,i=Object(h.b)(),j=function(e,t){return i(Object(g.d)(e,t))},x=(Object(s.h)(),(null===(t=e.match)||void 0===t?void 0:t.params).id),y=Object(d.useState)({data:[],total:0,totalPages:0,loading:!0,page:1}),w=Object(l.a)(y,2),N=w[0],k=w[1],_=Object(d.useState)(null),S=Object(l.a)(_,2),C=S[0],Y=S[1],E=Object(d.useState)(""),D=Object(l.a)(E,2),P=D[0],z=D[1],M=Object(d.useState)(""),V=Object(l.a)(M,2),A=V[0],B=V[1],L=Object(d.useState)({data:[],loading:!0,full:!1,page:1}),T=Object(l.a)(L,2),R=T[0],I=T[1],J=Object(d.useState)(null),q=Object(l.a)(J,2),H=q[0],W=q[1],F=Object(d.useState)({show:!1,id:"",name:""}),G=Object(l.a)(F,2),K=G[0],Q=G[1];Object(d.useEffect)((function(){j({method:"get",api:"/api/v1/admin/categories/".concat(x)},(function(e){var t=e.status,i=e.data;t===g.c?($(Object(c.a)({loading:!1},i)),ae(Object(c.a)(Object(c.a)({},ie),{},{editing:!1,value:i.title})),de(Object(c.a)(Object(c.a)({},le),{},{editing:!1,value:i.description}))):$(Object(c.a)(Object(c.a)({},Z),{},{loading:!1}))})),re("",1)}),[]),Object(d.useEffect)((function(){oe(P,1)}),[C,H]);var U=Object(d.useState)({loading:!0,title:"",description:""}),X=Object(l.a)(U,2),Z=X[0],$=X[1],ee=Object(d.useState)({editing:!1,loading:!1,value:""}),te=Object(l.a)(ee,2),ie=te[0],ae=te[1],ne=Object(d.useState)({editing:!1,loading:!1,value:""}),ce=Object(l.a)(ne,2),le=ce[0],de=ce[1];Object(d.useEffect)((function(){ie.editing&&je.current.focus()}),[ie.editing]),Object(d.useEffect)((function(){le.editing&&be.current.focus()}),[le.editing]),Object(d.useEffect)((function(){if(ie.editing||le.editing)return window.onbeforeunload=function(){return!0},function(){window.onbeforeunload=null}}),[ie.editing,le.editing]);var se=Object(a.jsx)("div",{});N.loading||N.total||(se=Object(a.jsx)("div",{children:"No videos"}));var oe=function(e,t){k((function(e){return Object(c.a)(Object(c.a)({},e),{},{loading:!0})})),j({method:"get",api:m.c.rest.getVideos(x,H?H.id:"",C?C.id:"",10,t,e,"")},(function(e){var i=e.status,a=e.data;i===g.c?k({data:a.video.map((function(e,i){return Object(v.a)(e,i,t)})),loading:!1,total:a.total,totalPages:Math.ceil(a.total/10),page:t}):k((function(e){return Object(c.a)(Object(c.a)({},e),{},{loading:!1})}))}))},re=function(e,t){j({method:"get",api:"/api/v1/admin/video/user?page_size=10&page_number=".concat(t,"&search_name=").concat(e)},(function(i){var a=i.status,c=i.data;a===g.c&&I((function(i){var a=c.users.map((function(e){return{id:e.id,name:e.first_name+" "+e.last_name}}));return{data:1===t?""===e?[null].concat(Object(n.a)(a)):a:[].concat(Object(n.a)(i.data),Object(n.a)(a)),loading:!1,full:c.users.length<10,page:t}}))}))},ue=function(e){e?ae(Object(c.a)(Object(c.a)({},ie),{},{loading:!0})):de(Object(c.a)(Object(c.a)({},le),{},{loading:!0})),j({method:"put",api:"/api/v1/admin/categories/".concat(x),body:{title:e?ie.value:Z.title,description:e?Z.description:le.value}},(function(t){t.status===g.c?e?(ae(Object(c.a)(Object(c.a)({},ie),{},{editing:!1,loading:!1})),$((function(e){return Object(c.a)(Object(c.a)({},e),{},{title:ie.value})}))):(de(Object(c.a)(Object(c.a)({},le),{},{editing:!1,loading:!1})),$((function(e){return Object(c.a)(Object(c.a)({},e),{},{description:le.value})}))):e?ae(Object(c.a)(Object(c.a)({},ie),{},{loading:!1})):de(Object(c.a)(Object(c.a)({},le),{},{loading:!1}))}))},je=Object(d.useRef)(null),be=Object(d.useRef)(null);return Object(a.jsxs)("div",{children:[(ie.editing||le.editing)&&Object(a.jsx)(s.a,{when:!0,message:"Changes you made may not be saved."}),Object(a.jsx)(o.a,{className:"pl-5 py-2 size-1",to:"/admin/mobility/categories",children:"Category Management"}),Object(a.jsx)("span",{className:"size-0 pl-2",children:"> Edit Category"}),Object(a.jsxs)("div",{className:"row p-5",children:[Object(a.jsx)(O.b,{isVisible:K.show,title:"Delete video",content:"Are you sure to delete the video ".concat(K.name),leftButtonText:"No",rightButtonText:"Yes",leftButtonOnPress:function(){return Q({show:!1,id:"",name:""})},rightButtonOnPress:function(){j({method:"delete",api:"/api/v1/admin/video/".concat(K.id),loading:!0},(function(e){e.status===g.c&&oe(P,1)})),Q({show:!1,id:"",name:""})},handleClose:function(){return Q({show:!1,id:"",name:""})}}),Object(a.jsx)("div",{className:"col-md-3 py-5 px-4",children:Z.loading?Object(a.jsx)("div",{style:{height:300,display:"flex",alignItems:"center"},children:f.e}):Object(a.jsxs)("div",{className:"pt-3 pr-3",children:[Object(a.jsx)("div",{className:"py-3",children:"Category"}),Object(a.jsxs)("div",{style:{position:"relative"},children:[Object(a.jsx)("input",{ref:je,className:"form-control",placeholder:"Category name",disabled:!ie.editing||ie.loading,value:ie.value,maxLength:100,onChange:function(e){return ae(Object(c.a)(Object(c.a)({},ie),{},{value:e.target.value}))}}),!ie.editing&&Object(a.jsx)("i",{className:"fa fa-pencil cursor-pointer",onClick:function(){return ae(Object(c.a)(Object(c.a)({},ie),{},{editing:!0}))},style:{position:"absolute",right:10,top:12}})]}),ie.editing&&Object(a.jsxs)("div",{className:"pt-3",style:{textAlign:"right",width:"100%"},children:[Object(a.jsx)(r.d,{style:{width:80},color:"secondary",className:"mr-3",onClick:function(){return ae(Object(c.a)(Object(c.a)({},ie),{},{editing:!1,value:Z.title}))},children:"Cancel"}),Object(a.jsx)(r.d,{style:{width:80},color:"primary",onClick:function(){return ue(!0)},disabled:""===ie.value.trim()||ie.loading||ie.value===Z.title,children:ie.loading?Object(a.jsx)(r.P,{size:"sm",color:"light"}):"Save"})]}),Object(a.jsx)("div",{className:"py-3",children:"Description"}),Object(a.jsxs)("div",{style:{position:"relative"},children:[Object(a.jsx)("textarea",{ref:be,className:"form-control",rows:12,placeholder:"Description",disabled:!le.editing||le.loading,value:le.value,maxLength:1e3,onChange:function(e){return de(Object(c.a)(Object(c.a)({},le),{},{value:e.target.value}))}}),!le.editing&&Object(a.jsx)("i",{className:"fa fa-pencil cursor-pointer",onClick:function(){return de(Object(c.a)(Object(c.a)({},le),{},{editing:!0}))},style:{position:"absolute",right:10,top:12}})]}),le.editing&&Object(a.jsxs)("div",{className:"pt-3",style:{textAlign:"right",width:"100%"},children:[Object(a.jsx)(r.d,{style:{width:80},color:"secondary",className:"mr-3",onClick:function(){return de(Object(c.a)(Object(c.a)({},le),{},{editing:!1,value:Z.description}))},children:"Cancel"}),Object(a.jsx)(r.d,{style:{width:80},color:"primary",onClick:function(){return ue(!1)},disabled:le.loading||le.value===Z.description,children:le.loading?Object(a.jsx)(r.P,{size:"sm",color:"light"}):"Save"})]})]})}),Object(a.jsxs)("div",{className:"col-md-9",children:[Object(a.jsx)("div",{className:"d-flex align-items-center justify-content-between mt-2 mb-5",children:Object(a.jsxs)("div",{className:"d-flex",children:[Object(a.jsx)("div",{style:{width:250},children:Object(a.jsx)(O.j,{searchName:P,setSearchName:z,className:"mr-3",searchEmpty:!0,callbackSearch:function(e){return oe(e,1)}})}),Object(a.jsx)("div",{style:{width:250},children:Object(a.jsx)(O.k,{className:"mr-3",selected:C,setSelected:Y,defaultValue:"Select status",data:m.f,loading:!1,full:!0,value:C?C.name:""})}),Object(a.jsx)("div",{style:{width:250},children:Object(a.jsx)(O.k,Object(c.a)(Object(c.a)({className:"mr-3",selected:H,setSelected:W,defaultValue:"Select uploader",value:A,setValue:B,callbackSearch:re},R),{},{validation:m.c.validate.valueTypingExpressionsName,maxLength:50}))})]})}),Object(a.jsx)("div",{style:{minHeight:"65vh",textAlign:"center"},children:Object(a.jsx)(r.l,{items:N.data,fields:p,loading:N.loading,noItemsViewSlot:se,hover:!0,striped:!0,scopedSlots:{no:function(e){return Object(a.jsx)("td",{className:"align-middle",children:e.no})},name:function(e){var t,i,n;return Object(a.jsx)("td",{className:"align-middle",title:(null===e||void 0===e||null===(t=e.name)||void 0===t?void 0:t.length)>30?null===e||void 0===e?void 0:e.name:"",children:Object(a.jsx)("span",{style:{overflowWrap:"break-word",display:"inline-block",width:150},children:(null===e||void 0===e||null===(i=e.name)||void 0===i?void 0:i.length)>30?(null===e||void 0===e||null===(n=e.name)||void 0===n?void 0:n.substring(0,27))+"...":null===e||void 0===e?void 0:e.name})})},description:function(e){var t,i,n;return Object(a.jsx)("td",{style:{height:80},className:"align-middle",title:(null===e||void 0===e||null===(t=e.description)||void 0===t?void 0:t.length)>60?null===e||void 0===e?void 0:e.description:"",children:(null===e||void 0===e||null===(i=e.description)||void 0===i?void 0:i.length)>60?(null===e||void 0===e||null===(n=e.description)||void 0===n?void 0:n.substring(0,57))+"...":null===e||void 0===e?void 0:e.description})},created_date:function(e){return Object(a.jsx)("td",{className:"align-middle",children:(null===e||void 0===e?void 0:e.created_date)?b()(1e3*(null===e||void 0===e?void 0:e.created_date)).format("DD/MM/YYYY"):"-"})},uploader:function(e){return Object(a.jsx)("td",{className:"align-middle",children:e.uploader})},views:function(e){return Object(a.jsx)("td",{className:"align-middle",children:e.views})},comment:function(e){return Object(a.jsx)("td",{className:"align-middle",children:e.comment})},like:function(e){return Object(a.jsx)("td",{className:"align-middle",children:e.like})},modified_date:function(e){return Object(a.jsx)("td",{className:"align-middle",children:(null===e||void 0===e?void 0:e.modified_date)?b()(1e3*(null===e||void 0===e?void 0:e.modified_date)).format("DD/MM/YYYY"):"-"})},status:function(e){return Object(a.jsx)("td",{className:"align-middle",children:e.status})},tag:function(e){if(!e.tag)return Object(a.jsx)("td",{className:"align-middle",children:"-"});var t=e.tag.split(","),i=t.length>2;return i&&(t[1]+=" ..."),Object(a.jsx)("td",{title:i?e.tag:"",className:"align-middle",children:t.slice(0,2).map((function(e){return Object(a.jsx)("div",{children:e})}))})},action:function(e){return Object(a.jsx)("td",{className:"align-middle",children:Object(a.jsx)(r.d,{color:"primary",variant:"outline",shape:"square",size:"sm",style:{marginRight:10},onClick:function(){return Q({show:!0,id:e.id,name:e.name})},children:Object(a.jsx)("i",{className:"fas fa-trash-alt",children:" "})})})}}})}),Object(f.h)(N.totalPages,N.page,(function(e){N.page!==e&&oe(P,e)}),N.total)]})]})]})}}}]);
//# sourceMappingURL=78.e062333d.chunk.js.map